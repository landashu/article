<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Hbase 优化 | 技术博客</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="人民万岁">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    
    <link rel="preload" href="/assets/css/1.styles.014bf4fe.css" as="style"><link rel="preload" href="/assets/js/app.3b062f61.js" as="script"><link rel="preload" href="/assets/js/11.5871899e.js" as="script"><link rel="preload" href="/assets/js/129.3978e98f.js" as="script">
    <link rel="stylesheet" href="/assets/css/1.styles.014bf4fe.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/assets/img/logo1.png" alt="技术博客" class="logo"> <span class="site-name can-hide">技术博客</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="语言" class="dropdown-title"><!----> <span class="title" style="display:;">语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/language/java/base/1/" class="nav-link">JAVA</a></li><li class="dropdown-item"><!----> <a href="/language/cj/1/" class="nav-link">仓颉</a></li><li class="dropdown-item"><!----> <a href="/language/mode/1/" class="nav-link">设计模式</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><!----> <span class="title" style="display:;">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frame/spring/200/" class="nav-link">Spring</a></li><li class="dropdown-item"><!----> <a href="/frame/mybatis/300/" class="nav-link">Mybatis</a></li><li class="dropdown-item"><!----> <a href="/frame/maven/2300/" class="nav-link">Maven</a></li><li class="dropdown-item"><!----> <a href="/frame/git/1/" class="nav-link">Git</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="中间件" class="dropdown-title"><!----> <span class="title" style="display:;">中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/kafka/1400/" class="nav-link">Kafka</a></li><li class="dropdown-item"><!----> <a href="/rabbitmq/1/" class="nav-link">RabbitMQ</a></li><li class="dropdown-item"><!----> <a href="/rocketmq/1/" class="nav-link">RocketMQ</a></li><li class="dropdown-item"><!----> <a href="/redis/1600/" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/zookeeper/1/" class="nav-link">Zookeeper </a></li><li class="dropdown-item"><!----> <a href="/nginx/1/" class="nav-link">Nginx</a></li><li class="dropdown-item"><!----> <a href="/mycat/1/" class="nav-link">数据库套件</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大数据" class="dropdown-title"><!----> <span class="title" style="display:;">大数据</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/mysql/1/" class="nav-link">MySQL</a></li><li class="dropdown-item"><!----> <a href="/es/1/" class="nav-link">Elasticsearch</a></li><li class="dropdown-item"><!----> <a href="/mongodb/1/" class="nav-link">MongoDB</a></li><li class="dropdown-item"><!----> <a href="/hadoop/1/" class="nav-link">Hadoop</a></li><li class="dropdown-item"><!----> <a href="/clickhouse/1/" class="nav-link">ClickHouse</a></li><li class="dropdown-item"><!----> <a href="/hbase/1/" class="nav-link">Hbase</a></li><li class="dropdown-item"><!----> <a href="/hive/1/" class="nav-link">Hive</a></li><li class="dropdown-item"><!----> <a href="/flink/1/" class="nav-link">Flink</a></li><li class="dropdown-item"><!----> <a href="/flume/1/" class="nav-link">Flume</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><!----> <span class="title" style="display:;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vue3/1900/" class="nav-link">VUE3</a></li><li class="dropdown-item"><!----> <a href="/wx/2000/" class="nav-link">微信小程序</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="运维" class="dropdown-title"><!----> <span class="title" style="display:;">运维</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/linux/2300/" class="nav-link">linux</a></li><li class="dropdown-item"><!----> <a href="/docker/400/" class="nav-link">Docker</a></li><li class="dropdown-item"><!----> <a href="/jenkins/500/" class="nav-link">Jenkins</a></li><li class="dropdown-item"><!----> <a href="/kubernetes/600/" class="nav-link">Kubernetes</a></li></ul></div></div> <a href="https://github.com/landashu?tab=repositories" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><!----> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="语言" class="dropdown-title"><!----> <span class="title" style="display:;">语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/language/java/base/1/" class="nav-link">JAVA</a></li><li class="dropdown-item"><!----> <a href="/language/cj/1/" class="nav-link">仓颉</a></li><li class="dropdown-item"><!----> <a href="/language/mode/1/" class="nav-link">设计模式</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="框架" class="dropdown-title"><!----> <span class="title" style="display:;">框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frame/spring/200/" class="nav-link">Spring</a></li><li class="dropdown-item"><!----> <a href="/frame/mybatis/300/" class="nav-link">Mybatis</a></li><li class="dropdown-item"><!----> <a href="/frame/maven/2300/" class="nav-link">Maven</a></li><li class="dropdown-item"><!----> <a href="/frame/git/1/" class="nav-link">Git</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="中间件" class="dropdown-title"><!----> <span class="title" style="display:;">中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/kafka/1400/" class="nav-link">Kafka</a></li><li class="dropdown-item"><!----> <a href="/rabbitmq/1/" class="nav-link">RabbitMQ</a></li><li class="dropdown-item"><!----> <a href="/rocketmq/1/" class="nav-link">RocketMQ</a></li><li class="dropdown-item"><!----> <a href="/redis/1600/" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/zookeeper/1/" class="nav-link">Zookeeper </a></li><li class="dropdown-item"><!----> <a href="/nginx/1/" class="nav-link">Nginx</a></li><li class="dropdown-item"><!----> <a href="/mycat/1/" class="nav-link">数据库套件</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大数据" class="dropdown-title"><!----> <span class="title" style="display:;">大数据</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/mysql/1/" class="nav-link">MySQL</a></li><li class="dropdown-item"><!----> <a href="/es/1/" class="nav-link">Elasticsearch</a></li><li class="dropdown-item"><!----> <a href="/mongodb/1/" class="nav-link">MongoDB</a></li><li class="dropdown-item"><!----> <a href="/hadoop/1/" class="nav-link">Hadoop</a></li><li class="dropdown-item"><!----> <a href="/clickhouse/1/" class="nav-link">ClickHouse</a></li><li class="dropdown-item"><!----> <a href="/hbase/1/" class="nav-link">Hbase</a></li><li class="dropdown-item"><!----> <a href="/hive/1/" class="nav-link">Hive</a></li><li class="dropdown-item"><!----> <a href="/flink/1/" class="nav-link">Flink</a></li><li class="dropdown-item"><!----> <a href="/flume/1/" class="nav-link">Flume</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><!----> <span class="title" style="display:;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vue3/1900/" class="nav-link">VUE3</a></li><li class="dropdown-item"><!----> <a href="/wx/2000/" class="nav-link">微信小程序</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="运维" class="dropdown-title"><!----> <span class="title" style="display:;">运维</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/linux/2300/" class="nav-link">linux</a></li><li class="dropdown-item"><!----> <a href="/docker/400/" class="nav-link">Docker</a></li><li class="dropdown-item"><!----> <a href="/jenkins/500/" class="nav-link">Jenkins</a></li><li class="dropdown-item"><!----> <a href="/kubernetes/600/" class="nav-link">Kubernetes</a></li></ul></div></div> <a href="https://github.com/landashu?tab=repositories" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>mysql</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mysql/1/" class="sidebar-link">MySQL 索引介绍</a></li><li><a href="/mysql/2/" class="sidebar-link">MySQL 锁介绍</a></li><li><a href="/mysql/3/" class="sidebar-link">MySQL 索引优化工具 explain</a></li><li><a href="/mysql/4/" class="sidebar-link">MySQL 主从复制（GTID）</a></li><li><a href="/mysql/5/" class="sidebar-link">MySQL 8安装</a></li><li><a href="/mysql/6/" class="sidebar-link">MySQL 8.x新特性总结</a></li><li><a href="/mysql/7/" class="sidebar-link">MySQL UDF以及新类型JSON</a></li><li><a href="/mysql/8/" class="sidebar-link">MySQL 高可用MGR(一) 理论</a></li><li><a href="/mysql/9/" class="sidebar-link">MySQL 高可用MGR(二) 搭建</a></li><li><a href="/mysql/10/" class="sidebar-link">MySQL 高可用MGR(三) 测试</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Elasticsearch</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/es/1/" class="sidebar-link">ES 7.8.0（一） 入门介绍</a></li><li><a href="/es/2/" class="sidebar-link">ES 7.8.0（二） 读、写和写索引流程以及文档分析过程</a></li><li><a href="/es/3/" class="sidebar-link">ES 7.8.0（三） 文档冲突</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>mongodb</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/mongodb/1/" class="sidebar-link">mongodb</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>hadoop</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/hadoop/1/" class="sidebar-link">Hadoop 伪分布式及集群</a></li><li><a href="/hadoop/2/" class="sidebar-link">Hadoop 指令</a></li><li><a href="/hadoop/3/" class="sidebar-link">Hadoop 读写流程详解</a></li><li><a href="/hadoop/4/" class="sidebar-link">Hadoop SpringBoot集成</a></li><li><a href="/hadoop/5/" class="sidebar-link">Hadoop MapReduce机制</a></li><li><a href="/hadoop/6/" class="sidebar-link">Hadoop YARN</a></li><li><a href="/hadoop/7/" class="sidebar-link">Hadoop MapReduce配置和编写job及数据倾斜的解决</a></li><li><a href="/hadoop/8/" class="sidebar-link">Hadoop MapReduce自定义格式输入输出</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>clickhouse</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/clickhouse/1/" class="sidebar-link">ClickHouse 介绍及安装</a></li><li><a href="/clickhouse/2/" class="sidebar-link">ClickHouse 数据类型</a></li><li><a href="/clickhouse/3/" class="sidebar-link">ClickHouse 表引擎</a></li><li><a href="/clickhouse/4/" class="sidebar-link">ClickHouse SQL操作</a></li><li><a href="/clickhouse/5/" class="sidebar-link">ClickHouse 副本配置</a></li><li><a href="/clickhouse/6/" class="sidebar-link">ClickHouse 分片与集群部署</a></li><li><a href="/clickhouse/7/" class="sidebar-link">ClickHouse Explain及建表优化</a></li><li><a href="/clickhouse/8/" class="sidebar-link">ClickHouse 语法优化规则</a></li><li><a href="/clickhouse/9/" class="sidebar-link">ClickHouse 查询优化</a></li><li><a href="/clickhouse/10/" class="sidebar-link">ClickHouse 数据一致性</a></li><li><a href="/clickhouse/11/" class="sidebar-link">ClickHouse 物化视图</a></li><li><a href="/clickhouse/12/" class="sidebar-link">ClickHouse MaterializeMySQL引擎</a></li><li><a href="/clickhouse/13/" class="sidebar-link">ClickHouse 监控及备份</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>hbase</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/hbase/1/" class="sidebar-link">Hbase 介绍及安装</a></li><li><a href="/hbase/2/" aria-current="page" class="active sidebar-link">Hbase 优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/hbase/2/#硬件和操作系统优化" class="sidebar-link">硬件和操作系统优化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/hbase/2/#配置内存" class="sidebar-link">配置内存</a></li><li class="sidebar-sub-header level3"><a href="/hbase/2/#配置cpu" class="sidebar-link">配置CPU</a></li><li class="sidebar-sub-header level3"><a href="/hbase/2/#垃圾回收器的选择" class="sidebar-link">垃圾回收器的选择</a></li><li class="sidebar-sub-header level3"><a href="/hbase/2/#jvm堆大小设置" class="sidebar-link">JVM堆大小设置</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/hbase/2/#hbase-调优" class="sidebar-link">Hbase 调优</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/hbase/2/#调节数据库-datablock-的大小" class="sidebar-link">调节数据库（dataBlock）的大小</a></li><li class="sidebar-sub-header level3"><a href="/hbase/2/#适当时机关闭数据块缓存" class="sidebar-link">适当时机关闭数据块缓存</a></li><li class="sidebar-sub-header level3"><a href="/hbase/2/#开启布隆过滤器" class="sidebar-link">开启布隆过滤器</a></li><li class="sidebar-sub-header level3"><a href="/hbase/2/#开启数据压缩" class="sidebar-link">开启数据压缩</a></li><li class="sidebar-sub-header level3"><a href="/hbase/2/#设置scan缓存" class="sidebar-link">设置Scan缓存</a></li><li class="sidebar-sub-header level3"><a href="/hbase/2/#显示地指定列" class="sidebar-link">显示地指定列</a></li><li class="sidebar-sub-header level3"><a href="/hbase/2/#关闭resultscanner" class="sidebar-link">关闭ResultScanner</a></li><li class="sidebar-sub-header level3"><a href="/hbase/2/#使用批量读" class="sidebar-link">使用批量读</a></li><li class="sidebar-sub-header level3"><a href="/hbase/2/#使用批量写" class="sidebar-link">使用批量写</a></li><li class="sidebar-sub-header level3"><a href="/hbase/2/#关闭写wal日志" class="sidebar-link">关闭写WAL日志</a></li><li class="sidebar-sub-header level3"><a href="/hbase/2/#设置autoflush" class="sidebar-link">设置AutoFlush</a></li><li class="sidebar-sub-header level3"><a href="/hbase/2/#预创建region" class="sidebar-link">预创建Region</a></li><li class="sidebar-sub-header level3"><a href="/hbase/2/#调整zookeeper-session的有效时长" class="sidebar-link">调整zookeeper Session的有效时长</a></li></ul></li></ul></li><li><a href="/hbase/3/" class="sidebar-link">Hbase phoenix安装及使用</a></li><li><a href="/hbase/4/" class="sidebar-link">Hbase LSM-TREE</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>hive</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/hive/1/" class="sidebar-link">Hive 介绍及安装</a></li><li><a href="/hive/2/" class="sidebar-link">Hive 内外部表、分区表、分桶表概念及hiveSQL命令</a></li><li><a href="/hive/3/" class="sidebar-link">Hive 数据类型</a></li><li><a href="/hive/4/" class="sidebar-link">Hive 函数 MySQL联合</a></li><li><a href="/hive/5/" class="sidebar-link">Hive 数据倾斜和优化</a></li><li><a href="/hive/56/" class="sidebar-link">Hive Sqoop安装及指令</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>flink</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/flink/1/" class="sidebar-link">Flink 介绍及安装</a></li><li><a href="/flink/2/" class="sidebar-link">Flink 配置介绍及Demo</a></li><li><a href="/flink/3/" class="sidebar-link">Flink API讲解</a></li><li><a href="/flink/4/" class="sidebar-link">Flink 运行架构</a></li><li><a href="/flink/5/" class="sidebar-link">Flink 时间语义及Watermark</a></li><li><a href="/flink/6/" class="sidebar-link">Flink 状态管理</a></li><li><a href="/flink/7/" class="sidebar-link">Flink 容错，检查点，保存点</a></li><li><a href="/flink/8/" class="sidebar-link">Flink 状态一致性</a></li><li><a href="/flink/9/" class="sidebar-link">Flink Table API 和 Flink SQL</a></li><li><a href="/flink/10/" class="sidebar-link">Flink CEP编程</a></li><li><a href="/flink/11/" class="sidebar-link">Flink Joining编程</a></li><li><a href="/flink/12/" class="sidebar-link">Flink CDC</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>flume</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/flume/1/" class="sidebar-link">Flume 日志收集系统介绍及安装</a></li><li><a href="/flume/2/" class="sidebar-link">Flume Source支持的类型</a></li><li><a href="/flume/3/" class="sidebar-link">Flume Sink支持的类型</a></li><li><a href="/flume/4/" class="sidebar-link">Flume Channel支持的类型</a></li><li><a href="/flume/5/" class="sidebar-link">Flume Selector</a></li><li><a href="/flume/6/" class="sidebar-link">Flume Interceptor拦截器类型</a></li><li><a href="/flume/7/" class="sidebar-link">Flume Process</a></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="placeholder"></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">Hbase 优化<!----></h1> <!----> <div class="theme-vdoing-content content__default"><blockquote><p>本文及后续所有文章都以 2.4.2 做为版本讲解和入门学习</p></blockquote> <h2 id="硬件和操作系统优化"><a href="#硬件和操作系统优化" class="header-anchor">#</a> 硬件和操作系统优化</h2> <h3 id="配置内存"><a href="#配置内存" class="header-anchor">#</a> 配置内存</h3> <p>Hbase 对于内存的消耗是非常巨大的，主要是其 LSM 树状结构、缓存机制和日志记录机制决定的，所以物理内存当然是越大越好。</p> <h3 id="配置cpu"><a href="#配置cpu" class="header-anchor">#</a> 配置 CPU</h3> <p>Hbase 给使用者的印象更偏于 &quot;内存型&quot; NoSql 数据库，从而忽略了 CPU 方面的需求，其实 Hbase 在某些应用上对 CPU 的消耗非常大，例如频繁使用过滤器，因为在过滤器中包含很多匹配、搜索和过滤的操作；多条件组合扫描的场景也是 CPU 密集型的；压缩操作很频繁等。如果服务器 CPU 不够强悍，会导致整个集群负载非常高，很多线程都在阻塞状态（非网络阻塞或死锁的情况）。</p> <h3 id="垃圾回收器的选择"><a href="#垃圾回收器的选择" class="header-anchor">#</a> 垃圾回收器的选择</h3> <p>对于运行 Hbase 相关进程 JVM 的垃圾回收器，不仅仅关注吞吐量，还关注停顿时间，而且两者之间停顿时间更为重要，因为 Hbase 设计的初衷就是解决大规模数据集下实时访问的问题。配置方式，需要在 hbase-env.sh 文件中</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token builtin class-name">export</span> <span class="token assign-left variable">HBASE_OPTS</span><span class="token operator">=</span><span class="token string">&quot;<span class="token variable">$HBASE_OPTS</span> -XX:+UseConcMarkSweepGC -XX:CMSInitiatingOccupancyFraction=60 -XX:+UseParNewGC -XX:ParallelGCThreads=6&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>简要说明一下，-XX:+UseConcMarkSweepGC 表示年老代并发收集；</p> <p>对于老年代来说， 它可以更早的开始回收。当分配在老年代的空间比率超过了一个阀值，CMS 开始运行。如果 CMS 开始的太晚，HBase 或许会直接进行 full garbage collection。这种情况会导致 block 所有的线程，如果这个时间过长，就会导致 hbase 连接超时，结果就是 regionserver 集体下线。这是不能容忍额。为了避免这种情况的发生，我们建议设置 -XX:CMSInitiatingOccupancyFraction JVM 参数来精确指定在多少百分比 CMS 应该被开始，正如上面的配置中做的那样。在 百分之 60 或 70 开始是一个好的实践。当老年代使用 CMS，默认的年轻代 GC 将被设置成 Parallel New Collector。</p> <p>再来看看 hbase 为什么可能进行 full gc，如果我们不配置 - XX:CMSInitiatingOccupancyFraction，jdk1.5 以后会使用默认值 90%，那么很可能，当老年代内存占用超过分配给他的内存大小的 90%，会进行 CMS（老年代的回收），但是不会阻止年轻代到老年代的迁移，如果迁移过快，CMS 较慢，会出现老年代内存使用率 100%，这时会导致 full gc。如果我们把这个参数调整小一点，那么能给年轻带到老年代迁移的同时做 CMS 时一些时间，也就减少了 full gc 的发生。当然这可能会频繁的 gc，但总比整个 hbase 挂掉的好不是么？</p> <h3 id="jvm堆大小设置"><a href="#jvm堆大小设置" class="header-anchor">#</a> JVM 堆大小设置</h3> <p>堆内存大小参数 hbase-env.sh 文件中设置</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token builtin class-name">export</span> <span class="token assign-left variable">HBASE_HEAPSIZE</span><span class="token operator">=</span><span class="token number">16284</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>上面代码中指定堆内存大小是 16284，单位是 MB，即 16GB。当然，这个值需要根据节点实际的物理内存来决定。一般不超过实际物理内存的二分之一。</p> <h2 id="hbase-调优"><a href="#hbase-调优" class="header-anchor">#</a> Hbase 调优</h2> <h3 id="调节数据库-datablock-的大小"><a href="#调节数据库-datablock-的大小" class="header-anchor">#</a> 调节数据库（dataBlock）的大小</h3> <p>HFile 数据库大小可以在列族层次设置。这个数据库不同于之前谈到的 HDFS 数据块，其默认值是 65536 字节，或 64KB。数据块索引存储每个 HFile 数据块的起始键。数据块大小的设置影响数据块索引的大小。数据块越小，索引越大，从而占用更大内存空间。同时加载进内存的数据块越小，随机查找性能更好。但是，如果需要更好的序列扫描性能，那么一次能够加载更多 HFile 数据进入内存更为合理，这意味着应该将数据块设置为更大的值。相应地，索引变小，将在随机读性能上付出更多的代价。可以在表实例化时设置数据块的大小：</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>create <span class="token string">'table_name'</span>,<span class="token punctuation">{</span>NAME <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'colfam1'</span>,BLOCKSIZE <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'65536'</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="适当时机关闭数据块缓存"><a href="#适当时机关闭数据块缓存" class="header-anchor">#</a> 适当时机关闭数据块缓存</h3> <p>把数据块放进读缓存，并不是一定能提示性能。如果一个表或表的列族只被顺序化扫描访问或很少被访问，则 Get 或 Scan 操作花费时间长一点是可以接受的。在这种情况下，可以选择关闭列族的缓存。</p> <p>关闭缓存的原因在于：如果只是执行很多顺序化扫描，会多次使用缓存，并且可能会滥用缓存，从而把应该放进缓存获得性能提升的数据给排挤出去。</p> <p>所以如果关闭缓存，不仅可以避免上述情况发生，而且可以让出更多缓存给其他表和同一表的其他列族使用。数据块缓存默认打开的。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>create <span class="token string">'table_name'</span>,<span class="token punctuation">{</span>NAME <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'colfam1'</span>,BLOCKSIZE <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'false'</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="开启布隆过滤器"><a href="#开启布隆过滤器" class="header-anchor">#</a> 开启布隆过滤器</h3> <p>数据块索引提供了一个有效的方法 getDataBlockIndexReader ()，在访问某个特定的行时用来查找应该读取的 HFile 的数据块。但是刚方法的作用有限。HFile 数据块的默认大小是 64KB，一边情况下不能调整太多。</p> <p>如果需要查找一个很短的行，只在整个数据的起始行键上建立索引是无法给出更细粒度的索引信息的。例如：某行占用 100 字节存储空间，一个 64KB 的数据包含（64*1024）/100=655.53，约 700 行，只能把起始行放在索引位上。要查找的行可能落在特定数据块上的行区间，但也不能肯定存放在那个数据块上，这就导致多种可能性；该行在表中不存在，或者存放在另一个 HFile 中，甚至在 MemStore 中。这些情况下，从硬盘读取数据块会带来 IO 开销，也会滥用数据块缓存，这会影响性能，尤其是当面对一个巨大的数据集且有很多并发读用户时。</p> <p>布隆过滤器允许对存储在每个数据块的数据做一个反向检测。当查询某行时，先检查布隆过滤器，看看该行是否不在这个数据块。布隆过滤器要么确定回答该行不在，要么回答不知道。因此称之为反向检查。布隆过滤器也可以应用到行内的单元格上，当访问某列标识符时先使用同样的反向检测。</p> <p>使用布隆过滤器也不是没有代价，相反，存储这个额外的索引层次占用空间。布隆过滤器的占用空间大小随着它们的索引对象数据增长而增长，所以行级布隆过滤器比列标识符级布隆过滤器占用空间要少。当空间不是问题，它们可以压榨整个系统的性能潜力。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>create <span class="token string">'table_name'</span>,<span class="token punctuation">{</span>NAME <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'colfam1'</span>,BLOOMFILTER<span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'ROWCOL'</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>布隆过滤器默认时 NONE。另外，还有两个值：ROW 表示行级布隆过滤器；ROWCOL 表示列标识符布隆过滤器。行级布隆过滤器在数据块中检查特定行键是否不存在，列标识符布隆过滤器检查行和列标识符联合体是否不存在。ROWCOL 布隆过滤器的空间开销高于 ROW 布隆过滤器。</p> <h3 id="开启数据压缩"><a href="#开启数据压缩" class="header-anchor">#</a> 开启数据压缩</h3> <p>HFile 可以被压缩并存放在 HDFS 上，有助于节省磁盘 IO，但是读写数据时压缩和解压缩会太高 CPU 利用率。压缩时表定义的一部分，可以在建表或模式改变时设定。除非确定压缩不会提升系统的性能，否则推荐打开表的压缩。只有在数据不能被压缩，或者因为某些原因服务器的 CPU 利用率有限制要求的情况下，有可能需要关闭压缩特性。</p> <p>Hbase 可以有多种压缩编码，包括 LZO、SNAPPY 和 GZIP，LZO 和 SNAPPY 是其中最流行的两种。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>create <span class="token string">'table_name'</span>,<span class="token punctuation">{</span>NAME <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'colfam1'</span>,COMPRESSION<span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token string">'SNAPPY'</span><span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>数据实在磁盘上压缩的，内存中（MemStore 和 BlockCache）或在网络传输时是没有压缩的。</p> <h3 id="设置scan缓存"><a href="#设置scan缓存" class="header-anchor">#</a> 设置 Scan 缓存</h3> <p>Hbase 的 Scan 查询中可以设置缓存，定义一次交互从服务器端传输到客户端的行数，设置方法是使用 Scan 类中 setCaching () 方法，这样能有效地减少服务器端和客户端的交互，更好地提升扫描查询的性能。</p> <h3 id="显示地指定列"><a href="#显示地指定列" class="header-anchor">#</a> 显示地指定列</h3> <p>当使用 Scan 或 Get 处理大量的行时，最好确定一下所需要的列。因为服务器端处理完的结果，需要通过网络传输到客户端，而且此时，传输的数据量成为瓶颈，如果能有效地过滤部分数据，使用更精确的需求，能够很大程度上减少网络 IO 的花费，否则会造成很大的资源浪费。如果在查询中指定某列或者某几列，能够有效地减少网络传输量，在一定程度上提升查询性能。</p> <h3 id="关闭resultscanner"><a href="#关闭resultscanner" class="header-anchor">#</a> 关闭 ResultScanner</h3> <p>ResultScanner 类用于存储服务端扫描的最终结果，可以通过遍历该类获取查询结果。但是，如果不关闭该类，可能会出现服务端在一段时间内保存连接，资源无法释放，从而导致服务器端某些资源的不可用，还有可能引发 HRegionServer 的其他问题。所以在使用完该类后，需要执行关闭操作。这一点与 JDBC 操作 MYSQL 类似，需要关闭连接。</p> <h3 id="使用批量读"><a href="#使用批量读" class="header-anchor">#</a> 使用批量读</h3> <p>通过调用 HTable.get (Get) 方法可以根据一个指定的行键获取 Hbase 表中的一行记录。同样 Hbase 提供了一个方法，通过调用 HTable.get (List&lt;Get&gt;) 方法可以根据一个指定的行键列表，批量获取多行记录。使用该方法可以在服务器端执行完批量查询后返回结果，降低网络传输的速度，节省网络 IO 开销，对于数据实时性要求高且网络传输 RTT 高的场景，能带来明显的性能提升。</p> <h3 id="使用批量写"><a href="#使用批量写" class="header-anchor">#</a> 使用批量写</h3> <p>通过调用 HTable.put (Put) 方法可以将一个指定的行键记录写入 Hbase。同样 Hbase 提供了一个方法，通过调用 HTable.put (List&lt;Put&gt;) 方法可以将指定多个行键批量写入，这样做的好处是批量执行，减少网络 IO 开销。</p> <h3 id="关闭写wal日志"><a href="#关闭写wal日志" class="header-anchor">#</a> 关闭写 WAL 日志</h3> <p>在默认情况下，为了保证系统的高可用性，写 WAL 日志默认开启状态。写 WAL 开启或关闭，在一定程度上确实会对系统性能产生很大影响，根据 Hbase 内部设计，WAL 是规避数据丢失风险的一种补偿机制，如果应用可以容忍一定的数据丢失的风险，可以尝试在更新数据时，闭关写 WAL。该方法存在的风险是，当 HRegionServer 宕机时，可能写入的数据会出现丢失的情况，且无法恢复。关闭写 WAL 操作通过 Put 类中的 writeToWAL () 设置。</p> <h3 id="设置autoflush"><a href="#设置autoflush" class="header-anchor">#</a> 设置 AutoFlush</h3> <p>Htable 有一个属性是 AutoFlush，该属性用于支持客户端的批量更新。该属性默认值是 true，即客户端每收到一条数据，立刻发送服务端。如果该属性值为 false，当客户端提交 Put 请求时，将该请求在客户端缓存，直到数据达到某个阀值的容量时（该容量参数 hbase.client.write.buff 决定）或执行 hbase.flushcommits () 时，才向 HRegionServer 提交请求。这种方式避免了每次跟服务端交互，采用批量提交的方式，所以更高效。但是，如果还没有达到该缓存而客户端崩溃，该部分数据将由于未发送到 HRegionServer 而丢失。这对于有些零容忍的在线服务是不可接受的。所以，设置该参数的时候要慎重。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code>table<span class="token punctuation">.</span><span class="token function">setAutoFlush</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
# 达到<span class="token number">12</span>M发出去
table<span class="token punctuation">.</span><span class="token function">setWriteBufferSize</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token operator">*</span><span class="token number">1024</span><span class="token operator">*</span><span class="token number">1024</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
# 或者手动发送
table<span class="token punctuation">.</span><span class="token function">flushCommits</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="预创建region"><a href="#预创建region" class="header-anchor">#</a> 预创建 Region</h3> <p>在 Hbase 中创建表时，该表一开始只有一个 Region，插入该表的所有数据会保存在该 Region 中。随着数据量不断增加，当该 Region 大小达到一定阀值时，就会发生分裂（Region Splitting）操作。并且在这个表创建后相当长的一段时间内，针对该表的所有写操作总是集中在某一台或者少数几台机器上，这不仅仅造成局部磁盘和网络资源紧张，同时也是对整个集群资源的浪费。这个问题在初始化表，即批量导入原始数据的时候，特别明显。为了解决这个问题，可以使用预创建 Region 的方法。</p> <p>Hbase 内部提供了 RegionSplitter 工具，使用命令如下</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token variable">${HBASE_HOME}</span>/bin/hbase org.apache.hadoop.hbase.util.RegionSplitter table_name HexStringSplit -c <span class="token number">10</span> -f cf1 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>其中，table_name 是表名，HexStringSplit 表示划分的算法，参数 - c 10 表示预创建 10 个 Region，-f cf1 表示创建一个名字为 cf1 的列族。</p> <h3 id="调整zookeeper-session的有效时长"><a href="#调整zookeeper-session的有效时长" class="header-anchor">#</a> 调整 zookeeper Session 的有效时长</h3> <p>参数 zookeeper.session.timeout 用于定义连接 Zookeeper 的 Session 的有效时长，这个默认值是 180 秒。这意味着一旦某个 HRegionServer 宕机，HMaster 至少需要 180 秒才能察觉到宕机，然后开始恢复。或者客户端读写过程中，如果服务端不能提供服务，客户端直到 180 秒后才能察觉到。在某些场景中，这样的时长可能对生产线业务来将不能容忍，需要调整这个值。在 hbase-site.xml 中配置。</p></div></div> <!----> <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">12/26/2024, 4:03:49 PM</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/hbase/1/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">Hbase 介绍及安装</div></a> <a href="/hbase/3/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">Hbase phoenix安装及使用</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/hbase/1/" class="prev">Hbase 介绍及安装</a></span> <span class="next"><a href="/hbase/3/">Hbase phoenix安装及使用</a>→
      </span></p></div></div></div> <!----></main></div> <div class="footer"><div class="icons"><a href="https://gitee.com/dashboard" title="gitee" target="_blank" class="iconfont icon-gitee"></a><a href="https://github.com/landashu?tab=repositories" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="mailto:875730567@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2023-2024
    <span>
<!--      <a href='https://doc.xugaoyi.com/' target='_blank'>Theme by Vdoing</a> | <a href='http://doc.aizuda.com/' rel='external nofollow' target='_blank'>Copyright © 2022-2023 AiZuDa</a>-->
<!--      <br>-->
<!--      <a href="http://beian.miit.gov.cn/" target="_blank">鲁ICP备2021041554号-1</a>-->
    </span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.3b062f61.js" defer></script><script src="/assets/js/11.5871899e.js" defer></script><script src="/assets/js/129.3978e98f.js" defer></script>
  </body>
</html>
