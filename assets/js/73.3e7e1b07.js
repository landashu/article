(window.webpackJsonp=window.webpackJsonp||[]).push([[73],{553:function(s,a,e){"use strict";e.r(a);var t=e(41),n=Object(t.a)({},(function(){var s=this,a=s.$createElement,e=s._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h2",{attrs:{id:"搭建"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#搭建"}},[s._v("#")]),s._v(" 搭建")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://mirrors.tuna.tsinghua.edu.cn/apache/kafka/2.7.0/kafka_2.13-2.7.0.tgz\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -xzf kafka_2.13-2.7.0.tgz\n"),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" kafka_2.13-2.7.0\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br")])]),e("blockquote",[e("p",[s._v("下载的 kafka 自带有 ZooKeeper，但很快，ZooKeeper 将不再被 Apache Kafka 所需要。")])]),s._v(" "),e("h3",{attrs:{id:"文件介绍"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#文件介绍"}},[s._v("#")]),s._v(" 文件介绍")]),s._v(" "),e("p",[s._v("kafka 安装好以后包含有以下文件")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost kafka_2.13-2.7.0"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nbin  config  libs  LICENSE  NOTICE  site-docs\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("ul",[e("li",[s._v("bin 包含 kafka 的 topic 脚本、kafka 启动脚本、ZooKeeper 启动脚本、生产者脚本、消费者脚本等")]),s._v(" "),e("li",[s._v("config  包含生产者配置、消费者配置、ZooKeeper 配置、kafka 配置以及一些 connect 配置")]),s._v(" "),e("li",[s._v("libs 主要是一些 jar 文件")])]),s._v(" "),e("blockquote",[e("p",[s._v("应用程序一般做为生产者和消费者，对于 kafka 服务配置只需要关心 ZooKeeper 和 kafka 本身配置即可，其余在应用本身可以控制")])]),s._v(" "),e("h3",{attrs:{id:"基础命令"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#基础命令"}},[s._v("#")]),s._v(" 基础命令")]),s._v(" "),e("p",[s._v("创建 topic，--replication-factor 副本数量 ，--partitions 分区数量，副本数量最好小于集群数量")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("./kafka-topics.sh --create --zookeeper ip:2181  --replication-factor "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" --partitions "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" --topic topic_name\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("删除 topic")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("./kafka-topics.sh --delete --zookeeper ip:2181 --topic topic_name\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("查看所有的 topic")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("./kafka-topics.sh --list --zookeeper ip:2181 \n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("查看某一个 topic 的详情")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("./kafka-topics.sh --zookeeper ip:2181 --describe --topic topic_name\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("启动 producer")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("./kafka-console-producer.sh --broker-list ip:9092  --topic topic_name\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("启动 consumer，--from-beginning 从头开始消费，没有之前生产的数据会丢弃")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("./kafka-console-consumer.sh --bootstrap-server ip:9092  --topic topic_name --from-beginning\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"启动"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#启动"}},[s._v("#")]),s._v(" 启动")]),s._v(" "),e("p",[s._v("启动 zookeeper")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 先修改配置")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /config/zookeeper.properties\n\nzookeeper.connect"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".81.62:2181\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("clientPortAddress")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".81.62\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动")]),s._v("\nbin/zookeeper-server-start.sh -daemon config/zookeeper.properties\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br")])]),e("p",[s._v("配置 kafka，并启动，如果是集群模式的话，只需要改 broker.id 即可")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 先修改配置")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /config/server.properties\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 集群模式下broker.id 必须唯一")]),s._v("\nbroker.id"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 消息的存储位置(持久化位置)")]),s._v("\nlog.dirs"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/tmp/kafka-logs\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置kafka允许被连接的ip和端口")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("listeners")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("PLAINTEXT://192.168.81.62:9092\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# zookeeper连接 多台zookeeper ',' 逗号分割")]),s._v("\nzookeeper.connect"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".81.62:2181\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动")]),s._v("\nbin/kafka-server-start.sh -daemon config/server.properties\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br")])]),e("p",[s._v("成功启动所有服务后，您将运行并可以使用基本的 Kafka 环境。")]),s._v(" "),e("blockquote",[e("p",[s._v("先关闭 kafka 再关闭 zookeeper，若先关闭了 zookeeper 导致 kafka 无法关闭，可以再启动 zookeeper 后关闭 kafka。")])]),s._v(" "),e("h2",{attrs:{id:"kafka-web-ui"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#kafka-web-ui"}},[s._v("#")]),s._v(" kafka web UI")]),s._v(" "),e("p",[e("a",{attrs:{href:"http://www.kafka-eagle.org/articles/docs/architecture/pdf.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方文档"),e("OutboundLink")],1),s._v("，我下载到了 window 本机，并没有在 linux 上操作，首先该 UI 要求有 java8 的环境配置中，然后把下载解压的文件也配置到环境变量中，否则会启动报错，而且变量必须叫 KE_HOME。")]),s._v(" "),e("p",[e("img",{attrs:{src:"/assets/img/kafka/1401/img.png",alt:""}})]),s._v(" "),e("p",[s._v("然后修改 D:\\tools\\kafka-eagle-web-2.0.4\\conf\\system-config.properties，复制以下配置到你的文件中就好了，很多的配置使用不到的，只需要修改 数据库连接 和 cluster1.zk.list 地址就好")]),s._v(" "),e("div",{staticClass:"language-properties line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("######################################")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# multi zookeeper & kafka cluster list")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("######################################")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("kafka.eagle.zk.cluster.alias")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("cluster1")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("cluster1.zk.list")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("192.168.81.62:2181")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("######################################")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# zookeeper enable acl")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("######################################")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("cluster1.zk.acl.enable")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("false")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("######################################")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# broker size online list")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("######################################")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("cluster1.kafka.eagle.broker.size")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("20")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("######################################")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# zk client thread limit")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("######################################")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("kafka.zk.limit.size")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("32")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("######################################")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kafka eagle webui port")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("######################################")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("kafka.eagle.webui.port")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("8048")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("######################################")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kafka jmx acl and ssl authenticate")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("######################################")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("cluster1.kafka.eagle.jmx.acl")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("false")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("######################################")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kafka offset storage")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("######################################")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("cluster1.kafka.eagle.offset.storage")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("kafka")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#cluster2.kafka.eagle.offset.storage=zk")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("######################################")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kafka jmx uri")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("######################################")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#cluster1.kafka.eagle.jmx.uri=service:jmx:rmi:///jndi/rmi://%s/jmxrmi")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("######################################")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kafka metrics, 15 days by default")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("######################################")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("kafka.eagle.metrics.charts")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("true")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("kafka.eagle.metrics.retain")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("15")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("######################################")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kafka sql topic records max")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("######################################")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("kafka.eagle.sql.topic.records.max")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("5000")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("######################################")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# delete kafka topic token")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("######################################")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("kafka.eagle.topic.token")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("keadmin")]),s._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("######################################")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kafka mysql jdbc driver address")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("######################################")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("kafka.eagle.driver")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("com.mysql.cj.jdbc.Driver")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("kafka.eagle.url")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("jdbc:mysql://192.168.81.61:3306/ke?useUnicode=true&characterEncoding=UTF-8&zeroDateTimeBehavior=convertToNull")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("kafka.eagle.username")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("root")]),s._v("\n"),e("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("kafka.eagle.password")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("Admin@123")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br"),e("span",{staticClass:"line-number"},[s._v("64")]),e("br"),e("span",{staticClass:"line-number"},[s._v("65")]),e("br")])]),e("p",[s._v("启动 D:\\tools\\kafka-eagle-web-2.0.4\\bin\\ke.bat")]),s._v(" "),e("p",[s._v("看到 tomcat 打印，需要多等待一些时间，如果等待太久可以先关闭 kafka 服务。")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("2021-02-20 16:44:06 INFO  [ZooKeeper.Thread-236] - Initiating client connection, connectString=192.168.81.62:2181 sessionTimeout=30000 watcher=kafka.zookeeper.ZooKeeperClient$ZooKeeperClientWatcher$@7bac5016\n2021-02-20 16:44:06 INFO  [ZooKeeperClient.Thread-236] - [ZooKeeperClient] Waiting until connected.\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("p",[e("img",{attrs:{src:"/assets/img/kafka/1401/img_1.png",alt:""}})]),s._v(" "),e("blockquote",[e("p",[s._v("常见的 web ui，安装方式：https://cloud.tencent.com/developer/article/1667262 下载地址：https://github.com/wolfogre/kafka-manager-docker/releases")])]),s._v(" "),e("h2",{attrs:{id:"参数解析"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参数解析"}},[s._v("#")]),s._v(" 参数解析")]),s._v(" "),e("p",[s._v("每个 broker 的唯一非负整数 id 的标识。")]),s._v(" "),e("div",{staticClass:"language-properties line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("broker.id")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("0")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("kafka 存放数据的路径，路径并不是只可以写一个，可以写多个用逗号分割，")]),s._v(" "),e("div",{staticClass:"language-properties line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("log.dirs")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("/tmp/kafka-logs")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("zookeeper 的连接")]),s._v(" "),e("div",{staticClass:"language-properties line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("zookeeper.connect")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("host:port,host:port")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("topic 的默认分区数量，一般消费者的数量尽量和分区数保持一致 1:1，否则会造成多个 消费者消费一个分区，或者分区过大，消费者消费不即时 (1 条 1 条消费)")]),s._v(" "),e("div",{staticClass:"language-properties line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("num.partitions")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("1")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("topic 分区里每个 log 文件的最大值")]),s._v(" "),e("div",{staticClass:"language-properties line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("log.segment.bytes")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("1024*1024*1024")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("即使以上参数没有达到文件的最大值，当创建时间达（24*7 = 一周）到此属性值，就会创建文件。")]),s._v(" "),e("div",{staticClass:"language-properties line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("log.roll.hours")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("24*7")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("每个 log index 的最大尺寸。如果 log index 尺寸达到这个数值，即使尺寸没有超过 log.segment.bytes 限制，也需要产生新得 log index")]),s._v(" "),e("div",{staticClass:"language-properties line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[s._v("log.index.size.max.bytes\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("如果一个 follower 在这个时间内没有发送 fetch 请求，leader 将从 ISR 中移除这个 follower")]),s._v(" "),e("div",{staticClass:"language-properties line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("replica.lag.time.max.ms")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("10000")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("备份时每次 fetch 的最大值")]),s._v(" "),e("div",{staticClass:"language-properties line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("replica.lag.fetch.max.bytes")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("1024*1024")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("指明了是否能够使不在 ISR 中 replicas 设置用来做为 leader")]),s._v(" "),e("div",{staticClass:"language-properties line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("unclean.leader.election.enable")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("true")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("是否能够删除 topic")]),s._v(" "),e("div",{staticClass:"language-properties line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("delete.topic.enable")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("false")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("生产者设置 kafka 集群")]),s._v(" "),e("div",{staticClass:"language-properties line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("boostrap.servers")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("host:port,host:port")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("生产者 ack 消息确定机制")]),s._v(" "),e("div",{staticClass:"language-properties line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("acks")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("1")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("生产者批量发送消息 (以 16384 字节数为一批)，此参数调整须是 1024 整数倍")]),s._v(" "),e("div",{staticClass:"language-properties line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("batch.size")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("16384")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("p",[s._v("生产者发送消息的间隔，0 代表有数据立马发送，如果要使用批处理，该值建议调在 1s 以内，根据实际数据量的大小计算。")]),s._v(" "),e("div",{staticClass:"language-properties line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-properties"}},[e("code",[e("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("linger.ms")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("0")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h2",{attrs:{id:"阿里云中部署注意事项"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#阿里云中部署注意事项"}},[s._v("#")]),s._v(" 阿里云中部署注意事项")]),s._v(" "),e("p",[s._v("阿里云中的端口开放需要如下方式，使用 iptables 根本无效")]),s._v(" "),e("div",{staticClass:"language-shell line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-shell"}},[e("code",[s._v("firewall-cmd --zone"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("public --add-port"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2181")]),s._v("/tcp --permanent\nfirewall-cmd --zone"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("public --add-port"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("9092")]),s._v("/tcp --permanent\nfirewall-cmd --zone"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("public --add-port"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v("/tcp --permanent\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])]),e("p",[s._v("配置 IP 需要注意，zookeeper 可以直接走内网，加到 zookeeper 链接超时时间"),e("br"),s._v(" "),e("img",{attrs:{src:"/assets/img/kafka/1401/img_2.png",alt:""}})])])}),[],!1,null,null,null);a.default=n.exports}}]);