(window.webpackJsonp=window.webpackJsonp||[]).push([[75],{551:function(s,e,a){"use strict";a.r(e);var t=a(41),n=Object(t.a)({},(function(){var s=this,e=s.$createElement,a=s._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("Redis（REmote DIctionary Server）是一个开源的使用 ANSI C 编写、支持网络、可基于内存亦可持久化的日志型、Key-Value 数据库，并提供多种语言的 API。从名字上看，Redis 的名称来自西班牙的 “红色” 这个词，意味着 “红色灯笼” 或 “红色旗帜”，表示对数据库快速、可扩展、高可靠性的追求。")]),s._v(" "),a("h2",{attrs:{id:"redis的来历"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#redis的来历"}},[s._v("#")]),s._v(" Redis 的来历")]),s._v(" "),a("p",[s._v("Redis 的诞生可以追溯到 2009 年，当时 Salvatore Sanfilippo（即 antirez）为了解决自己在使用 Memcached 时遇到的一些问题，开始开发 Redis。Memcached 是一个开源的内存中的数据缓存系统，主要用于减少数据库访问次数，以提高网站的访问速度。然而，Sanfilippo 发现 Memcached 的功能过于简单，无法满足一些复杂的需求，如数据持久化和数据同步等。因此，他决定开发一个全新的数据库，以满足这些需求。")]),s._v(" "),a("h2",{attrs:{id:"为何需要redis"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#为何需要redis"}},[s._v("#")]),s._v(" 为何需要 Redis")]),s._v(" "),a("p",[s._v("随着互联网的发展，数据量不断增长，传统的关系型数据库在处理大量数据时，性能逐渐下降。同时，随着分布式系统的普及，数据一致性和同步问题也变得越来越突出。Redis 的出现，就是为了解决这些问题。")]),s._v(" "),a("p",[s._v("首先，Redis 是内存数据库，读写速度非常快，可以满足高并发、大数据量的处理需求。其次，Redis 支持多种数据结构，包括字符串、哈希、列表、集合和有序集合等，可以满足各种复杂的业务需求。最后，Redis 还提供了丰富的数据操作和事务控制功能，可以保证数据的一致性和可靠性。")]),s._v(" "),a("h2",{attrs:{id:"redis的功能"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#redis的功能"}},[s._v("#")]),s._v(" Redis 的功能")]),s._v(" "),a("ol",[a("li",[s._v("数据结构：Redis 支持多种数据结构，包括字符串、哈希、列表、集合和有序集合等。这些数据结构可以满足各种复杂的业务需求。")]),s._v(" "),a("li",[s._v("数据操作：Redis 提供了丰富的数据操作和事务控制功能，包括增加、删除、修改和查询等操作。同时，Redis 还支持事务控制和乐观锁等机制，可以保证数据的一致性和可靠性。")]),s._v(" "),a("li",[s._v("数据持久化：Redis 支持多种数据持久化方式，包括 RDB 和 AOF 等。RDB 通过生成数据快照的方式进行持久化，而 AOF 则通过记录操作日志的方式进行持久化。这两种方式都可以保证数据的可靠性和恢复能力。")]),s._v(" "),a("li",[s._v("数据同步：Redis 支持主从复制和集群复制两种方式进行数据同步。主从复制可以实现读写分离和负载均衡等功能，而集群复制则可以实现数据的分布式存储和容灾等功能。")]),s._v(" "),a("li",[s._v("分布式锁：Redis 提供了分布式锁功能，可以在分布式系统中实现资源共享和并发控制等功能。")]),s._v(" "),a("li",[s._v("其他功能：除了上述功能外，Redis 还支持消息队列、发布订阅、Lua 脚本等功能。")])]),s._v(" "),a("h2",{attrs:{id:"redis的应用场景"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#redis的应用场景"}},[s._v("#")]),s._v(" Redis 的应用场景")]),s._v(" "),a("ol",[a("li",[s._v("缓存：Redis 作为内存数据库，读写速度非常快，可以作为缓存层使用。通过将热点数据存储在 Redis 中，可以减少对后端数据库的访问次数，提高网站的访问速度。")]),s._v(" "),a("li",[s._v("分布式系统：Redis 支持分布式存储和复制等功能，可以用于构建分布式系统。通过将数据分散到多个节点上存储，可以实现数据的分布式处理和容灾等功能。")]),s._v(" "),a("li",[s._v("消息队列：Redis 可以作为消息队列使用，可以实现异步处理和消息的发布订阅等功能。通过将消息存储在 Redis 中，可以实现消息的持久化和可靠传输等功能。")]),s._v(" "),a("li",[s._v("数据库扩展：Redis 可以作为数据库的扩展使用，可以实现数据的快速读写和处理等功能。通过将部分数据存储在 Redis 中，可以减轻数据库的压力，提高系统的性能和可靠性。")]),s._v(" "),a("li",[s._v("实时分析：Redis 的快速读写能力使其成为实时分析工具的理想选择。它可以作为数据缓冲层，为实时分析提供足够的数据存储空间和查询性能。")]),s._v(" "),a("li",[s._v("社交网络：Redis 可以用于实现社交网络中的各种功能，如用户认证、内容发布、好友关系管理等。它的高速读写和丰富的数据结构使得这些操作变得简单高效。")]),s._v(" "),a("li",[s._v("游戏开发：在游戏开发中，Redis 可以作为后端服务器的一部分来处理游戏逻辑和玩家数据。它提供的高性能和快速响应使得游戏体验更加流畅。")]),s._v(" "),a("li",[s._v("物联网：在物联网应用中，Redis 可以用于存储和管理传感器数据、设备状态等信息。它的持久化和分布式特性使得物联网设备能够可靠地共享和同步数据。")]),s._v(" "),a("li",[s._v("缓存网关：Redis 可以作为缓存网关来优化 API 请求的性能。它能够快速地响应 API 请求并减少对后端服务的调用次数，从而提高系统的吞吐量和响应速度。")]),s._v(" "),a("li",[s._v("实时推荐系统：在实时推荐系统中，Redis 可以用于存储用户行为数据、商品信息等实时更新的数据。它能够快速地处理推荐算法的计算和查询请求，为用户提供个性化的推荐服务。")])]),s._v(" "),a("h2",{attrs:{id:"redis的未来"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#redis的未来"}},[s._v("#")]),s._v(" Redis 的未来")]),s._v(" "),a("p",[s._v("随着互联网的不断发展，Redis 的应用场景也将越来越广泛。未来，Redis 可能会在以下几个方面有更大的发展：")]),s._v(" "),a("ol",[a("li",[s._v("分布式系统：随着云计算和大数据技术的发展，分布式系统将更加普及。Redis 作为分布式系统的重要组成部分，将会在数据存储、数据同步和容灾等方面发挥更大的作用。")]),s._v(" "),a("li",[s._v("人工智能：人工智能的发展需要大量的数据处理和分析，Redis 的高性能和丰富的数据结构可以满足这些需求。未来，Redis 可能会在人工智能领域有更广泛的应用。")]),s._v(" "),a("li",[s._v("物联网：物联网的发展需要大量的数据采集和处理，Redis 的高性能和低延迟可以满足这些需求。未来，Redis 可能会在物联网领域有更广泛的应用。")]),s._v(" "),a("li",[s._v("区块链：区块链技术需要大量的数据存储和验证，Redis 的高可靠性和数据持久化可以满足这些需求。未来，Redis 可能会在区块链领域有更广泛的应用。")])]),s._v(" "),a("h2",{attrs:{id:"redis6-安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#redis6-安装"}},[s._v("#")]),s._v(" Redis6 安装")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://download.redis.io/releases/redis-6.0.9.tar.gz\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" xzf redis-6.0.9.tar.gz\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" redis-6.0.9\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("如果安装报错，查看 gcc 版本")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("gcc -v\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("centos7 默认版本为 4.8.5，而 redis6.0 + 需要的 gcc 版本为 5.3 及以上，所以升级 gcc 即可")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("//升级gcc到9以上\nyum -y "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" centos-release-scl\nyum -y "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" devtoolset-9-gcc devtoolset-9-gcc-c++ devtoolset-9-binutils\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("//临时将此时的gcc版本改为9\nscl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" devtoolset-9 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v("\n//或永久改变\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"source /opt/rh/devtoolset-9/enable"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v("/etc/profile\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("查看 gcc 版本")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("gcc -v\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("重新 make 即可。")]),s._v(" "),a("h3",{attrs:{id:"redis启动三个警告"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#redis启动三个警告"}},[s._v("#")]),s._v(" redis 启动三个警告")]),s._v(" "),a("p",[s._v("tcp-blok 积压问题")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("WARNING: The TCP backlog setting of "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("511")]),s._v(" cannot be enforced because /proc/sys/net/core/somaxconn is "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" to the lower value of "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("128")]),s._v(".\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("内存设置为 0！在内存不足的情况下，后台保存可能会失败，建议设置为 1.")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("WARNING overcommit_memory is "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" to "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" Background save may fail under low memory condition. To fix this issue "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'vm.overcommit_memory = 1'")]),s._v(" to /etc/sysctl.conf and "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("reboot")]),s._v(" or run the "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'sysctl vm.overcommit_memory=1'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" this to take effect.\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("操作系统默认的内存页大小是 4kB，可以如果使用更大的内存页比如 2MB，就可以使用同样多的页表项，管理更大的内存空间，但是对于 redis 这样的内存数据库，它会导致内存分配的速度变慢，并且导致内存的实际使用率下降，因此 redis 推荐我们关闭此项")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("WARNING you have Transparent Huge Pages "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("THP"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" support enabled "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" your kernel. This will create latency and memory usage issues with Redis. To fix this issue run the "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'echo madvise > /sys/kernel/mm/transparent_hugepage/enabled'")]),s._v(" as root, and "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" it to your /etc/rc.local "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" order to retain the setting after a reboot. Redis must be restarted after THP is disabled "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("set to "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'madvise'")]),s._v(" or "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'never'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"前两个问题解决如下"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前两个问题解决如下"}},[s._v("#")]),s._v(" 前两个问题解决如下：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/sysctl.conf \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("加入如下")]),s._v(" "),a("div",{staticClass:"language-properties line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-properties"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# redis 设置挤压,可以查看redis.cnf 文件里也有关于tcp-backlog")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("net.core.somaxconn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("2048")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 和tcp-backlog 有关")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("net.ipv4.tcp_max_syn_backlog")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("2048")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 内存设置为0！在内存不足的情况下，后台保存可能会失败")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token attr-name"}},[s._v("vm.overcommit_memory")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[s._v("1")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("查看是否添加")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("sysctl -p\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"最后一个问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#最后一个问题"}},[s._v("#")]),s._v(" 最后一个问题")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/rc.local \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("加入如下")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" madvise "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /sys/kernel/mm/transparent_hugepage/enabled\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("让配置生效")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("source")]),s._v(" /etc/rc.local \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])}),[],!1,null,null,null);e.default=n.exports}}]);